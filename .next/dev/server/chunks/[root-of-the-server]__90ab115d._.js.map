{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ROSE%20MEHRA/Downloads/Mtathagat/clean-project/app/api/contact/route.ts"],"sourcesContent":["// app/api/contact/route.ts\r\nimport nodemailer from \"nodemailer\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\ntype Body = {\r\n  name?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  message?: string;\r\n};\r\n\r\nconst sanitize = (s?: string) => (s || \"\").trim();\r\n\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const body: Body = await request.json();\r\n\r\n    const name = sanitize(body.name);\r\n    const phone = sanitize(body.phone);\r\n    const email = sanitize(body.email);\r\n    const message = sanitize(body.message);\r\n\r\n    // basic validation\r\n    if (!phone) {\r\n      return NextResponse.json({ error: \"Phone number is required.\" }, { status: 400 });\r\n    }\r\n\r\n    // Build email content (HTML + plain)\r\n    const subject = `New contact form enquiry from ${name || \"Unknown\"}`;\r\n    const plain = `\r\nNew contact form submission\r\n\r\nName: ${name || \"—\"}\r\nPhone: ${phone}\r\nEmail: ${email || \"—\"}\r\nMessage:\r\n${message || \"—\"}\r\n    `.trim();\r\n\r\n    const html = `\r\n      <h2>New contact form submission</h2>\r\n      <p><strong>Name:</strong> ${name || \"—\"}</p>\r\n      <p><strong>Phone:</strong> ${phone}</p>\r\n      <p><strong>Email:</strong> ${email || \"—\"}</p>\r\n      <p><strong>Message:</strong></p>\r\n      <pre style=\"white-space:pre-wrap;\">${message || \"—\"}</pre>\r\n      <hr/>\r\n      <p>Sent from: your website</p>\r\n    `;\r\n\r\n    // Create transporter using env vars\r\n    // Required env vars: SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS, FROM_EMAIL (optional), TO_EMAIL (optional)\r\n    const host = process.env.SMTP_HOST;\r\n    const port = parseInt(process.env.SMTP_PORT || \"587\", 10);\r\n    const user = process.env.SMTP_USER;\r\n    const pass = process.env.SMTP_PASS;\r\n\r\n    if (!host || !user || !pass) {\r\n      console.error(\"SMTP credentials missing. Make sure SMTP_HOST, SMTP_USER, SMTP_PASS are set.\");\r\n      return NextResponse.json({ error: \"Mailer not configured.\" }, { status: 500 });\r\n    }\r\n\r\n    const fromEmail = process.env.FROM_EMAIL || \"info@mtdevelopers.com\";\r\n    const toEmail = process.env.TO_EMAIL || \"info@mtdevelopers.com\";\r\n\r\n    const transporter = nodemailer.createTransport({\r\n      host,\r\n      port,\r\n      secure: port === 465, // true for 465, false for other ports\r\n      auth: {\r\n        user,\r\n        pass,\r\n      },\r\n    });\r\n\r\n    // optional: verify transporter once (not required every request)\r\n    // await transporter.verify();\r\n\r\n    const mailResult = await transporter.sendMail({\r\n      from: `\"Website Contact\" <${fromEmail}>`,\r\n      to: toEmail,\r\n      subject,\r\n      text: plain,\r\n      html,\r\n      replyTo: email || undefined,\r\n    });\r\n\r\n    console.log(\"Contact form email sent:\", mailResult);\r\n\r\n    return NextResponse.json({ ok: true, message: \"Email sent.\" });\r\n  } catch (err: any) {\r\n    console.error(\"Error in /api/contact:\", err);\r\n    return NextResponse.json({ error: \"Internal server error.\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;AAC3B;AACA;;;AASA,MAAM,WAAW,CAAC,IAAe,CAAC,KAAK,EAAE,EAAE,IAAI;AAExC,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAa,MAAM,QAAQ,IAAI;QAErC,MAAM,OAAO,SAAS,KAAK,IAAI;QAC/B,MAAM,QAAQ,SAAS,KAAK,KAAK;QACjC,MAAM,QAAQ,SAAS,KAAK,KAAK;QACjC,MAAM,UAAU,SAAS,KAAK,OAAO;QAErC,mBAAmB;QACnB,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,qCAAqC;QACrC,MAAM,UAAU,CAAC,8BAA8B,EAAE,QAAQ,WAAW;QACpE,MAAM,QAAQ,CAAC;;;MAGb,EAAE,QAAQ,IAAI;OACb,EAAE,MAAM;OACR,EAAE,SAAS,IAAI;;AAEtB,EAAE,WAAW,IAAI;IACb,CAAC,CAAC,IAAI;QAEN,MAAM,OAAO,CAAC;;gCAEc,EAAE,QAAQ,IAAI;iCACb,EAAE,MAAM;iCACR,EAAE,SAAS,IAAI;;yCAEP,EAAE,WAAW,IAAI;;;IAGtD,CAAC;QAED,oCAAoC;QACpC,4GAA4G;QAC5G,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;QAClC,MAAM,OAAO,SAAS,QAAQ,GAAG,CAAC,SAAS,IAAI,OAAO;QACtD,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;QAClC,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;QAElC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM;YAC3B,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAC9E;QAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,UAAU,IAAI;QAC5C,MAAM,UAAU,QAAQ,GAAG,CAAC,QAAQ,IAAI;QAExC,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;YAC7C;YACA;YACA,QAAQ,SAAS;YACjB,MAAM;gBACJ;gBACA;YACF;QACF;QAEA,iEAAiE;QACjE,8BAA8B;QAE9B,MAAM,aAAa,MAAM,YAAY,QAAQ,CAAC;YAC5C,MAAM,CAAC,mBAAmB,EAAE,UAAU,CAAC,CAAC;YACxC,IAAI;YACJ;YACA,MAAM;YACN;YACA,SAAS,SAAS;QACpB;QAEA,QAAQ,GAAG,CAAC,4BAA4B;QAExC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,SAAS;QAAc;IAC9D,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACF","debugId":null}}]
}